#!/bin/sh
# .husky/pre-push

echo "üîç Running static checks before push..."

# SECURITY: Check for .env files first (fast, critical)
if ! ./scripts/validation/check-no-env-files.sh; then
    echo ""
    echo "‚ùå SECURITY: .env files detected. Remove them before pushing."
    exit 1
fi

# Run comprehensive checks:
# - Type checking (Turbo cached)
# - Linting (Turbo cached)
# - Format checking (Turbo cached)
# - Unit tests
if ! bun run static-check; then
    echo ""
    echo "‚ùå Pre-push check failed. Fix the issues above before pushing."
    echo "   Run 'bun run static-check' locally to verify fixes."
    echo "   To skip this check (not recommended): git push --no-verify"
    exit 1
fi

echo "‚úÖ All checks passed. Proceeding with push..."
